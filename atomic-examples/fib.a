use everything from #IMPORT "atomic-stdlib/stdlib.a"

use everything from nat
use cons,nil,reverse from list
use putStrLn from io
use y from combinators

asciiDigitOffset = '0'

tallies n = n (\l.cons 'I' l) (cons '.' nil)
putInt n = putStrLn (tallies n)

natToStringPrecursor rec n = cons (add asciiDigitOffset (rem n 10)) ((lessthanorequal 9 n) (rec (divide n 10)) nil)
natToString n = reverse (y natToStringPrecursor n)

fib = y \rec n.lessthanorequal n 1 1 (add (rec (minus n 1)) (rec (minus n 2)))

range n m = m (\t x.cons x (t (suc x))) (\x.nil) n

reveal (range 0 10) (\h t.putStrLn (natToString (fib h)) t) EXIT